# 导航栏测试指南

## 📋 测试目标

验证不同角色的用户看到正确的导航菜单和功能入口。

---

## 🔧 快速测试

### 1. 启动开发服务器

```bash
npm run dev
```

### 2. 测试不同角色的导航

#### ✅ 未登录状态
**预期导航**:
```
Art RWA  |  首页  |  艺术品市场  |  艺术家  |  [登录按钮]
```

**验证点**:
- ✓ 没有"个人中心"下拉菜单
- ✓ 只显示"登录"按钮
- ✓ 所有公共页面可访问

---

#### 👤 普通用户 (role='user')
**预期导航**:
```
Art RWA  |  首页  |  艺术品市场  |  艺术家  |  [个人中心 ▼]  |  [0x395e...d75e]
```

**个人中心菜单**:
```
个人中心
─────────────
👤 我的主页
❤️ 我的收藏
🛒 我的订单
💰 钱包管理
⚙️ 账户设置
─────────────
🎨 申请成为艺术家  ← 重点入口
```

**测试步骤**:
1. 使用 Privy 登录
2. 点击"个人中心"下拉菜单
3. 验证所有菜单项显示正确
4. 点击"申请成为艺术家"链接（应跳转到 `/apply-artist`）

**如何模拟**:
```sql
-- 在 Supabase SQL Editor 中执行
UPDATE users
SET role = 'user'
WHERE privy_user_id = '你的privy_user_id';
```

---

#### 🎨 艺术家 (role='artist')
**预期导航**:
```
Art RWA  |  首页  |  艺术品市场  |  艺术家  |  [个人中心 ▼]  |  [0x395e...d75e]
```

**个人中心菜单**:
```
艺术家中心
─────────────
👤 艺术家主页
🎨 我的作品
➕ 发布新作品  ← 核心功能
📊 数据统计
💵 收益管理
💰 钱包管理
⚙️ 账户设置
```

**测试步骤**:
1. 切换角色为 artist
2. 刷新页面
3. 点击"个人中心"，标题应显示"艺术家中心"
4. 验证"发布新作品"入口存在
5. 点击"发布新作品"（应跳转到 `/artist/submit`）

**如何模拟**:
```sql
-- 在 Supabase SQL Editor 中执行
UPDATE users
SET role = 'artist'
WHERE privy_user_id = '你的privy_user_id';

-- 同时在 artists 表中创建记录
INSERT INTO artists (privy_user_id, artist_name, artist_bio)
VALUES ('你的privy_user_id', '测试艺术家', '这是测试艺术家')
ON CONFLICT (privy_user_id) DO NOTHING;
```

---

#### 👨‍💼 管理员 (role='admin')
**预期导航**:
```
Art RWA  |  首页  |  艺术品市场  |  艺术家  |  [个人中心 ▼]  |  [0x395e...d75e]
```

**个人中心菜单**:
```
管理中心
─────────────
👤 我的主页
─────────────
审核管理
✓ 艺术家审核  ← 重点功能
✓ 作品审核    ← 重点功能
─────────────
系统管理
📊 平台数据
👥 用户管理
💰 钱包管理
🛡️ 系统设置
```

**测试步骤**:
1. 切换角色为 admin
2. 刷新页面
3. 点击"个人中心"，标题应显示"管理中心"
4. 验证审核管理菜单分组显示
5. 点击"艺术家审核"（应跳转到 `/admin/review/artists`）
6. 点击"作品审核"（应跳转到 `/admin/review/artworks`）

**如何模拟**:
```sql
-- 在 Supabase SQL Editor 中执行
UPDATE users
SET role = 'admin'
WHERE privy_user_id = '你的privy_user_id';
```

---

## 🎯 核心业务流程测试

### 流程1: 用户申请成为艺术家

```
1. 以 user 角色登录
   └─> 导航: 个人中心 → 申请成为艺术家

2. 填写申请表单
   ├─ 艺术家名称
   ├─ 个人简介
   ├─ 作品集链接
   └─ 上传认证材料

3. 提交申请
   └─> 后台创建 artist_applications 记录（待实现）

4. 管理员审核
   └─> 导航: 个人中心 → 艺术家审核
   └─> 查看申请列表，批准或拒绝

5. 审核通过后
   ├─> 更新 users.role = 'artist'
   ├─> 创建 artists 表记录
   └─> 用户导航自动更新为"艺术家中心"
```

### 流程2: 艺术家发布作品

```
1. 以 artist 角色登录
   └─> 导航: 个人中心 → 发布新作品

2. 填写作品信息
   ├─ 作品标题、描述
   ├─ 上传作品图片
   ├─ 代币名称、符号、总量
   └─ 提交审核（status='pending'）

3. 管理员审核作品
   └─> 导航: 个人中心 → 作品审核
   └─> 查看待审核作品，批准或拒绝

4. 审核通过后
   ├─> 更新 artworks.status = 'approved'
   ├─> 触发 NFT 铸造流程
   └─> 作品出现在"艺术品市场"
```

---

## 🐛 常见问题排查

### 问题1: 登录后看不到"个人中心"菜单

**原因**: useAuth hook 返回的 user 为 null

**排查步骤**:
1. 打开浏览器开发者工具 Console
2. 查看是否有认证错误日志
3. 检查 localStorage 中的 `supabase_user`
4. 验证 Supabase Edge Function 是否正常工作

**解决方法**:
```bash
# 检查 Edge Function 日志
supabase functions logs auth-privy

# 或在浏览器 Console 执行
console.log(localStorage.getItem('supabase_user'))
```

### 问题2: 角色切换后导航没有更新

**原因**: 缓存未清除

**解决方法**:
1. 退出登录
2. 清除浏览器缓存
3. 重新登录

或手动清除:
```javascript
// 在浏览器 Console 执行
localStorage.removeItem('supabase_session');
localStorage.removeItem('supabase_user');
window.location.reload();
```

### 问题3: 点击菜单项显示 404

**原因**: 对应页面尚未创建

**解决方法**: 这是正常的，页面将在后续开发中逐步创建。当前重点测试导航菜单的显示逻辑。

---

## ✅ 验收标准

- [ ] 未登录用户只看到公共导航和"登录"按钮
- [ ] 普通用户看到"个人中心"和"申请成为艺术家"入口
- [ ] 艺术家看到"艺术家中心"和"发布新作品"入口
- [ ] 管理员看到"管理中心"和审核相关入口
- [ ] 角色切换后导航菜单正确更新
- [ ] 活跃链接高亮显示（当前页面）
- [ ] 所有菜单项图标正确显示

---

## 📝 测试记录模板

```markdown
### 测试日期: 2026-01-29
### 测试人员: [你的名字]

| 角色 | 导航显示 | 菜单项数量 | 核心功能入口 | 状态 |
|------|---------|-----------|-------------|------|
| 未登录 | ✅ | - | - | ✅ |
| user | ✅ | 6 | 申请成为艺术家 | ✅ |
| artist | ✅ | 7 | 发布新作品 | ✅ |
| admin | ✅ | 9 | 审核中心 | ✅ |

### 发现的问题:
1. [记录问题]

### 备注:
[其他说明]
```

---

**文档版本**: v1.0
**最后更新**: 2026-01-29
